11-06-2025 01:57:44 - svm - INFO - modular_svm - <module> - Project Root: /scratch/s5130727/Applied-ML
11-06-2025 01:57:44 - svm - INFO - modular_svm - <module> - Splits Directory used by SVM: /scratch/s5130727/Applied-ML/data/data_splits
11-06-2025 01:57:44 - svm - INFO - modular_svm - <module> - Results Directory: /scratch/s5130727/Applied-ML/results5
11-06-2025 01:57:44 - svm - INFO - modular_svm - main_svm - Plotting outputs will be saved to: /scratch/s5130727/Applied-ML/results5
11-06-2025 01:57:44 - svm - INFO - modular_svm - main_svm - 
--- Processing Fusion Configuration 1/4: eeg ---
11-06-2025 01:57:44 - svm - INFO - modular_svm - load_data - Loading data for modalities: ['eeg'] for config 'eeg'
11-06-2025 01:57:44 - svm - INFO - modular_svm - load_data - Data loaded successfully for config 'eeg'
11-06-2025 01:57:44 - svm - INFO - modular_svm - load_data - Shapes: X_train: (15460, 16), y_train: (15460,)
11-06-2025 01:57:44 - svm - INFO - modular_svm - load_data - Shapes: X_val: (488, 16), y_val: (488,)
11-06-2025 01:57:44 - svm - INFO - modular_svm - load_data - Shapes: X_test: (1115, 16), y_test: (1115,)
11-06-2025 01:57:44 - svm - INFO - modular_svm - main_svm - Building SVM Pipeline and Training Model for 'eeg'...
11-06-2025 01:57:44 - svm - INFO - modular_svm - main_svm - Combining X_train and X_val for  RandomizedSearchCV hyperparameter tuning.
11-06-2025 01:57:44 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Min samples per class in HP tuning data: 8
11-06-2025 01:57:44 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - SMOTE k_neighbors robustly set to: 5 based on n_splits=5
11-06-2025 01:57:44 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Starting RandomizedSearchCV with cv=5...
11-06-2025 03:52:09 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best SVM Params from RandomizedSearchCV: {'feature_selection__k': 10, 'pca__n_components': None, 'svm__estimator__C': np.float64(30.682658024414046), 'svm__estimator__gamma': 0.1}
11-06-2025 03:52:09 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best ROC AUC (CV): 0.8592
11-06-2025 03:52:10 - svm - INFO - modular_svm - plot_grid_search_results - RandomizedSearchCV results plot saved to: /scratch/s5130727/Applied-ML/results5/gs_results_eeg.png
11-06-2025 03:52:10 - svm - ERROR - modular_svm - plot_search_history - Could not plot search history: 'mean_train_score'
11-06-2025 03:52:10 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Training set for config 'eeg' ---
11-06-2025 03:56:48 - svm - INFO - modular_svm - _evaluate_model - ROC curves saved to: /scratch/s5130727/Applied-ML/results5/roc_eeg_training.png
11-06-2025 03:56:48 - svm - INFO - modular_svm - _evaluate_model - SVM Training Performance (Config: eeg):
11-06-2025 03:56:48 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.20      1.00      0.33         8
     Class 1       0.25      0.87      0.39       368
     Class 2       0.29      0.76      0.42       656
     Class 3       0.97      0.65      0.78     10892
     Class 4       0.50      0.80      0.62      2008
     Class 5       0.56      0.71      0.63      1528

    accuracy                           0.68     15460
   macro avg       0.46      0.80      0.53     15460
weighted avg       0.82      0.68      0.72     15460

11-06-2025 03:56:48 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.6842, Macro F1: 0.5270, ROC AUC (OVR Macro): 0.9029272239632139
11-06-2025 03:56:48 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Training - Config: eeg):
[[   8    0    0    0    0    0]
 [   1  320   13    5   19   10]
 [   1   27  500   18   43   67]
 [  24  708  944 7049 1452  715]
 [   4  118   95  108 1610   73]
 [   2   93  187   61   95 1090]]
11-06-2025 03:56:48 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_training.png
11-06-2025 03:56:48 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Validation set for config 'eeg' ---
11-06-2025 03:56:54 - svm - WARNING - modular_svm - _evaluate_model - (Validation set, config eeg) Could not compute ROC AUC (ValueError): Number of given labels, 4, not equal to the number of columns in 'y_score', 6.
11-06-2025 03:56:54 - svm - INFO - modular_svm - _evaluate_model - SVM Validation Performance (Config: eeg):
11-06-2025 03:56:54 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       0.86      0.86      0.86         7
     Class 2       0.33      0.49      0.39        43
     Class 3       0.99      0.85      0.92       383
     Class 4       0.00      0.00      0.00         0
     Class 5       0.46      0.73      0.56        55

    accuracy                           0.81       488
   macro avg       0.44      0.49      0.46       488
weighted avg       0.87      0.81      0.83       488

11-06-2025 03:56:54 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.8074, Macro F1: 0.6826, ROC AUC (OVR Macro): N/A
11-06-2025 03:56:54 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Validation - Config: eeg):
[[  0   0   0   0   0   0]
 [  0   6   0   0   0   1]
 [  0   0  21   2   0  20]
 [  0   1  29 327   0  26]
 [  0   0   0   0   0   0]
 [  0   0  14   1   0  40]]
11-06-2025 03:56:54 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_validation.png
11-06-2025 03:56:54 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Test set for config 'eeg' ---
11-06-2025 03:57:07 - svm - WARNING - modular_svm - _evaluate_model - (Test set, config eeg) Could not compute ROC AUC (ValueError): Number of given labels, 5, not equal to the number of columns in 'y_score', 6.
11-06-2025 03:57:07 - svm - INFO - modular_svm - _evaluate_model - SVM Test Performance (Config: eeg):
11-06-2025 03:57:07 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       1.00      0.46      0.63        48
     Class 2       0.25      0.32      0.28        85
     Class 3       0.84      0.84      0.84       665
     Class 4       0.70      0.89      0.78       187
     Class 5       0.69      0.47      0.56       130

    accuracy                           0.75      1115
   macro avg       0.58      0.49      0.51      1115
weighted avg       0.76      0.75      0.75      1115

11-06-2025 03:57:07 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.7462, Macro F1: 0.6176, ROC AUC (OVR Macro): N/A
11-06-2025 03:57:07 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Test - Config: eeg):
[[  0   0   0   0   0   0]
 [  0  22  10  14   0   2]
 [  0   0  27  35   3  20]
 [  0   0  34 556  69   6]
 [  0   0   1  20 166   0]
 [  0   0  35  34   0  61]]
11-06-2025 03:57:08 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_test.png
11-06-2025 03:57:08 - svm - INFO - modular_svm - main_svm - Successfully saved best model for 'eeg' to: /scratch/s5130727/Applied-ML/results5/svm_model_eeg.joblib
11-06-2025 03:57:08 - svm - INFO - modular_svm - main_svm - Preparing a plot-safe estimator for the learning curve.
11-06-2025 03:57:08 - svm - INFO - modular_svm - main_svm - Set smote__k_neighbors=1 in plot-safe estimator.
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:528: FitFailedWarning: 
2 fits failed out of a total of 25.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
2 fits failed with the following error:
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 518, in fit
    Xt, yt = self._fit(X, y, routed_params, raw_params=params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 440, in _fit
    X, y, fitted_transformer = fit_resample_one_cached(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/joblib/memory.py", line 326, in __call__
    return self.func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 1336, in _fit_resample_one
    X_res, y_res = sampler.fit_resample(X, y, **params.get("fit_resample", {}))
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 105, in fit_resample
    output = self._fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/over_sampling/_smote/base.py", line 359, in _fit_resample
    nns = self.nn_k_.kneighbors(X_class, return_distance=False)[:, 1:]
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/neighbors/_base.py", line 854, in kneighbors
    raise ValueError(
ValueError: Expected n_neighbors <= n_samples_fit, but n_neighbors = 2, n_samples_fit = 1, n_samples = 1

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/scratch/s5130727/Applied-ML/src/models/modular_svm.py:728: RuntimeWarning: Mean of empty slice
  val_scores_mean = np.nanmean(val_scores, axis=1)
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/numpy/lib/_nanfunctions_impl.py:2019: RuntimeWarning: Degrees of freedom <= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
11-06-2025 04:15:29 - svm - INFO - modular_svm - plot_learning_curve - Learning curve plot saved to: /scratch/s5130727/Applied-ML/results5/lc_eeg.png
11-06-2025 04:15:29 - svm - INFO - modular_svm - main_svm - Metrics for 'eeg' saved to: /scratch/s5130727/Applied-ML/results5/metrics_eeg.json
11-06-2025 04:15:29 - svm - INFO - modular_svm - main_svm - 
--- Processing Fusion Configuration 2/4: eeg_emg ---
11-06-2025 04:15:29 - svm - INFO - modular_svm - load_data - Loading data for modalities: ['eeg', 'emg'] for config 'eeg_emg'
11-06-2025 04:15:29 - svm - INFO - modular_svm - load_data - Data loaded successfully for config 'eeg_emg'
11-06-2025 04:15:29 - svm - INFO - modular_svm - load_data - Shapes: X_train: (15460, 17), y_train: (15460,)
11-06-2025 04:15:29 - svm - INFO - modular_svm - load_data - Shapes: X_val: (488, 17), y_val: (488,)
11-06-2025 04:15:29 - svm - INFO - modular_svm - load_data - Shapes: X_test: (1115, 17), y_test: (1115,)
11-06-2025 04:15:29 - svm - INFO - modular_svm - main_svm - Building SVM Pipeline and Training Model for 'eeg_emg'...
11-06-2025 04:15:29 - svm - INFO - modular_svm - main_svm - Combining X_train and X_val for  RandomizedSearchCV hyperparameter tuning.
11-06-2025 04:15:29 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Min samples per class in HP tuning data: 8
11-06-2025 04:15:29 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - SMOTE k_neighbors robustly set to: 5 based on n_splits=5
11-06-2025 04:15:29 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Starting RandomizedSearchCV with cv=5...
11-06-2025 06:14:12 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best SVM Params from RandomizedSearchCV: {'feature_selection__k': 10, 'pca__n_components': None, 'svm__estimator__C': np.float64(30.682658024414046), 'svm__estimator__gamma': 0.1}
11-06-2025 06:14:12 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best ROC AUC (CV): 0.8592
11-06-2025 06:14:13 - svm - INFO - modular_svm - plot_grid_search_results - RandomizedSearchCV results plot saved to: /scratch/s5130727/Applied-ML/results5/gs_results_eeg_emg.png
11-06-2025 06:14:13 - svm - ERROR - modular_svm - plot_search_history - Could not plot search history: 'mean_train_score'
11-06-2025 06:14:13 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Training set for config 'eeg_emg' ---
11-06-2025 06:18:44 - svm - INFO - modular_svm - _evaluate_model - ROC curves saved to: /scratch/s5130727/Applied-ML/results5/roc_eeg_emg_training.png
11-06-2025 06:18:44 - svm - INFO - modular_svm - _evaluate_model - SVM Training Performance (Config: eeg_emg):
11-06-2025 06:18:44 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.20      1.00      0.33         8
     Class 1       0.25      0.87      0.39       368
     Class 2       0.29      0.76      0.42       656
     Class 3       0.97      0.65      0.78     10892
     Class 4       0.50      0.80      0.62      2008
     Class 5       0.56      0.71      0.63      1528

    accuracy                           0.68     15460
   macro avg       0.46      0.80      0.53     15460
weighted avg       0.82      0.68      0.72     15460

11-06-2025 06:18:44 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.6842, Macro F1: 0.5270, ROC AUC (OVR Macro): 0.9029272239632139
11-06-2025 06:18:44 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Training - Config: eeg_emg):
[[   8    0    0    0    0    0]
 [   1  320   13    5   19   10]
 [   1   27  500   18   43   67]
 [  24  708  944 7049 1452  715]
 [   4  118   95  108 1610   73]
 [   2   93  187   61   95 1090]]
11-06-2025 06:18:44 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_emg_training.png
11-06-2025 06:18:44 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Validation set for config 'eeg_emg' ---
11-06-2025 06:18:50 - svm - WARNING - modular_svm - _evaluate_model - (Validation set, config eeg_emg) Could not compute ROC AUC (ValueError): Number of given labels, 4, not equal to the number of columns in 'y_score', 6.
11-06-2025 06:18:50 - svm - INFO - modular_svm - _evaluate_model - SVM Validation Performance (Config: eeg_emg):
11-06-2025 06:18:50 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       0.86      0.86      0.86         7
     Class 2       0.33      0.49      0.39        43
     Class 3       0.99      0.85      0.92       383
     Class 4       0.00      0.00      0.00         0
     Class 5       0.46      0.73      0.56        55

    accuracy                           0.81       488
   macro avg       0.44      0.49      0.46       488
weighted avg       0.87      0.81      0.83       488

11-06-2025 06:18:50 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.8074, Macro F1: 0.6826, ROC AUC (OVR Macro): N/A
11-06-2025 06:18:50 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Validation - Config: eeg_emg):
[[  0   0   0   0   0   0]
 [  0   6   0   0   0   1]
 [  0   0  21   2   0  20]
 [  0   1  29 327   0  26]
 [  0   0   0   0   0   0]
 [  0   0  14   1   0  40]]
11-06-2025 06:18:50 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_emg_validation.png
11-06-2025 06:18:50 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Test set for config 'eeg_emg' ---
11-06-2025 06:19:03 - svm - WARNING - modular_svm - _evaluate_model - (Test set, config eeg_emg) Could not compute ROC AUC (ValueError): Number of given labels, 5, not equal to the number of columns in 'y_score', 6.
11-06-2025 06:19:03 - svm - INFO - modular_svm - _evaluate_model - SVM Test Performance (Config: eeg_emg):
11-06-2025 06:19:03 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       1.00      0.46      0.63        48
     Class 2       0.25      0.32      0.28        85
     Class 3       0.84      0.84      0.84       665
     Class 4       0.70      0.89      0.78       187
     Class 5       0.69      0.47      0.56       130

    accuracy                           0.75      1115
   macro avg       0.58      0.49      0.51      1115
weighted avg       0.76      0.75      0.75      1115

11-06-2025 06:19:03 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.7462, Macro F1: 0.6176, ROC AUC (OVR Macro): N/A
11-06-2025 06:19:03 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Test - Config: eeg_emg):
[[  0   0   0   0   0   0]
 [  0  22  10  14   0   2]
 [  0   0  27  35   3  20]
 [  0   0  34 556  69   6]
 [  0   0   1  20 166   0]
 [  0   0  35  34   0  61]]
11-06-2025 06:19:03 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_emg_test.png
11-06-2025 06:19:03 - svm - INFO - modular_svm - main_svm - Successfully saved best model for 'eeg_emg' to: /scratch/s5130727/Applied-ML/results5/svm_model_eeg_emg.joblib
11-06-2025 06:19:03 - svm - INFO - modular_svm - main_svm - Preparing a plot-safe estimator for the learning curve.
11-06-2025 06:19:03 - svm - INFO - modular_svm - main_svm - Set smote__k_neighbors=1 in plot-safe estimator.
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:528: FitFailedWarning: 
2 fits failed out of a total of 25.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
2 fits failed with the following error:
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 518, in fit
    Xt, yt = self._fit(X, y, routed_params, raw_params=params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 440, in _fit
    X, y, fitted_transformer = fit_resample_one_cached(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/joblib/memory.py", line 326, in __call__
    return self.func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 1336, in _fit_resample_one
    X_res, y_res = sampler.fit_resample(X, y, **params.get("fit_resample", {}))
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 105, in fit_resample
    output = self._fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/over_sampling/_smote/base.py", line 359, in _fit_resample
    nns = self.nn_k_.kneighbors(X_class, return_distance=False)[:, 1:]
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/neighbors/_base.py", line 854, in kneighbors
    raise ValueError(
ValueError: Expected n_neighbors <= n_samples_fit, but n_neighbors = 2, n_samples_fit = 1, n_samples = 1

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/scratch/s5130727/Applied-ML/src/models/modular_svm.py:728: RuntimeWarning: Mean of empty slice
  val_scores_mean = np.nanmean(val_scores, axis=1)
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/numpy/lib/_nanfunctions_impl.py:2019: RuntimeWarning: Degrees of freedom <= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
11-06-2025 06:37:46 - svm - INFO - modular_svm - plot_learning_curve - Learning curve plot saved to: /scratch/s5130727/Applied-ML/results5/lc_eeg_emg.png
11-06-2025 06:37:46 - svm - INFO - modular_svm - main_svm - Metrics for 'eeg_emg' saved to: /scratch/s5130727/Applied-ML/results5/metrics_eeg_emg.json
11-06-2025 06:37:46 - svm - INFO - modular_svm - main_svm - 
--- Processing Fusion Configuration 3/4: eeg_eog ---
11-06-2025 06:37:46 - svm - INFO - modular_svm - load_data - Loading data for modalities: ['eeg', 'eog'] for config 'eeg_eog'
11-06-2025 06:37:46 - svm - INFO - modular_svm - load_data - Data loaded successfully for config 'eeg_eog'
11-06-2025 06:37:46 - svm - INFO - modular_svm - load_data - Shapes: X_train: (15460, 18), y_train: (15460,)
11-06-2025 06:37:46 - svm - INFO - modular_svm - load_data - Shapes: X_val: (488, 18), y_val: (488,)
11-06-2025 06:37:46 - svm - INFO - modular_svm - load_data - Shapes: X_test: (1115, 18), y_test: (1115,)
11-06-2025 06:37:46 - svm - INFO - modular_svm - main_svm - Building SVM Pipeline and Training Model for 'eeg_eog'...
11-06-2025 06:37:46 - svm - INFO - modular_svm - main_svm - Combining X_train and X_val for  RandomizedSearchCV hyperparameter tuning.
11-06-2025 06:37:46 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Min samples per class in HP tuning data: 8
11-06-2025 06:37:46 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - SMOTE k_neighbors robustly set to: 5 based on n_splits=5
11-06-2025 06:37:46 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Starting RandomizedSearchCV with cv=5...
11-06-2025 08:39:21 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best SVM Params from RandomizedSearchCV: {'feature_selection__k': 10, 'pca__n_components': None, 'svm__estimator__C': np.float64(30.682658024414046), 'svm__estimator__gamma': 0.1}
11-06-2025 08:39:21 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best ROC AUC (CV): 0.8592
11-06-2025 08:39:22 - svm - INFO - modular_svm - plot_grid_search_results - RandomizedSearchCV results plot saved to: /scratch/s5130727/Applied-ML/results5/gs_results_eeg_eog.png
11-06-2025 08:39:22 - svm - ERROR - modular_svm - plot_search_history - Could not plot search history: 'mean_train_score'
11-06-2025 08:39:22 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Training set for config 'eeg_eog' ---
11-06-2025 08:44:02 - svm - INFO - modular_svm - _evaluate_model - ROC curves saved to: /scratch/s5130727/Applied-ML/results5/roc_eeg_eog_training.png
11-06-2025 08:44:02 - svm - INFO - modular_svm - _evaluate_model - SVM Training Performance (Config: eeg_eog):
11-06-2025 08:44:02 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.20      1.00      0.33         8
     Class 1       0.25      0.87      0.39       368
     Class 2       0.29      0.76      0.42       656
     Class 3       0.97      0.65      0.78     10892
     Class 4       0.50      0.80      0.62      2008
     Class 5       0.56      0.71      0.63      1528

    accuracy                           0.68     15460
   macro avg       0.46      0.80      0.53     15460
weighted avg       0.82      0.68      0.72     15460

11-06-2025 08:44:02 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.6842, Macro F1: 0.5270, ROC AUC (OVR Macro): 0.9029272239632139
11-06-2025 08:44:02 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Training - Config: eeg_eog):
[[   8    0    0    0    0    0]
 [   1  320   13    5   19   10]
 [   1   27  500   18   43   67]
 [  24  708  944 7049 1452  715]
 [   4  118   95  108 1610   73]
 [   2   93  187   61   95 1090]]
11-06-2025 08:44:02 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_eog_training.png
11-06-2025 08:44:02 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Validation set for config 'eeg_eog' ---
11-06-2025 08:44:08 - svm - WARNING - modular_svm - _evaluate_model - (Validation set, config eeg_eog) Could not compute ROC AUC (ValueError): Number of given labels, 4, not equal to the number of columns in 'y_score', 6.
11-06-2025 08:44:08 - svm - INFO - modular_svm - _evaluate_model - SVM Validation Performance (Config: eeg_eog):
11-06-2025 08:44:08 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       0.86      0.86      0.86         7
     Class 2       0.33      0.49      0.39        43
     Class 3       0.99      0.85      0.92       383
     Class 4       0.00      0.00      0.00         0
     Class 5       0.46      0.73      0.56        55

    accuracy                           0.81       488
   macro avg       0.44      0.49      0.46       488
weighted avg       0.87      0.81      0.83       488

11-06-2025 08:44:08 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.8074, Macro F1: 0.6826, ROC AUC (OVR Macro): N/A
11-06-2025 08:44:08 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Validation - Config: eeg_eog):
[[  0   0   0   0   0   0]
 [  0   6   0   0   0   1]
 [  0   0  21   2   0  20]
 [  0   1  29 327   0  26]
 [  0   0   0   0   0   0]
 [  0   0  14   1   0  40]]
11-06-2025 08:44:08 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_eog_validation.png
11-06-2025 08:44:08 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Test set for config 'eeg_eog' ---
11-06-2025 08:44:21 - svm - WARNING - modular_svm - _evaluate_model - (Test set, config eeg_eog) Could not compute ROC AUC (ValueError): Number of given labels, 5, not equal to the number of columns in 'y_score', 6.
11-06-2025 08:44:21 - svm - INFO - modular_svm - _evaluate_model - SVM Test Performance (Config: eeg_eog):
11-06-2025 08:44:21 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       1.00      0.46      0.63        48
     Class 2       0.25      0.32      0.28        85
     Class 3       0.84      0.84      0.84       665
     Class 4       0.70      0.89      0.78       187
     Class 5       0.69      0.47      0.56       130

    accuracy                           0.75      1115
   macro avg       0.58      0.49      0.51      1115
weighted avg       0.76      0.75      0.75      1115

11-06-2025 08:44:21 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.7462, Macro F1: 0.6176, ROC AUC (OVR Macro): N/A
11-06-2025 08:44:21 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Test - Config: eeg_eog):
[[  0   0   0   0   0   0]
 [  0  22  10  14   0   2]
 [  0   0  27  35   3  20]
 [  0   0  34 556  69   6]
 [  0   0   1  20 166   0]
 [  0   0  35  34   0  61]]
11-06-2025 08:44:21 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_eog_test.png
11-06-2025 08:44:21 - svm - INFO - modular_svm - main_svm - Successfully saved best model for 'eeg_eog' to: /scratch/s5130727/Applied-ML/results5/svm_model_eeg_eog.joblib
11-06-2025 08:44:21 - svm - INFO - modular_svm - main_svm - Preparing a plot-safe estimator for the learning curve.
11-06-2025 08:44:21 - svm - INFO - modular_svm - main_svm - Set smote__k_neighbors=1 in plot-safe estimator.
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:528: FitFailedWarning: 
2 fits failed out of a total of 25.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
2 fits failed with the following error:
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 518, in fit
    Xt, yt = self._fit(X, y, routed_params, raw_params=params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 440, in _fit
    X, y, fitted_transformer = fit_resample_one_cached(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/joblib/memory.py", line 326, in __call__
    return self.func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 1336, in _fit_resample_one
    X_res, y_res = sampler.fit_resample(X, y, **params.get("fit_resample", {}))
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 105, in fit_resample
    output = self._fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/over_sampling/_smote/base.py", line 359, in _fit_resample
    nns = self.nn_k_.kneighbors(X_class, return_distance=False)[:, 1:]
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/neighbors/_base.py", line 854, in kneighbors
    raise ValueError(
ValueError: Expected n_neighbors <= n_samples_fit, but n_neighbors = 2, n_samples_fit = 1, n_samples = 1

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/scratch/s5130727/Applied-ML/src/models/modular_svm.py:728: RuntimeWarning: Mean of empty slice
  val_scores_mean = np.nanmean(val_scores, axis=1)
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/numpy/lib/_nanfunctions_impl.py:2019: RuntimeWarning: Degrees of freedom <= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
11-06-2025 09:02:41 - svm - INFO - modular_svm - plot_learning_curve - Learning curve plot saved to: /scratch/s5130727/Applied-ML/results5/lc_eeg_eog.png
11-06-2025 09:02:41 - svm - INFO - modular_svm - main_svm - Metrics for 'eeg_eog' saved to: /scratch/s5130727/Applied-ML/results5/metrics_eeg_eog.json
11-06-2025 09:02:41 - svm - INFO - modular_svm - main_svm - 
--- Processing Fusion Configuration 4/4: eeg_emg_eog ---
11-06-2025 09:02:41 - svm - INFO - modular_svm - load_data - Loading data for modalities: ['eeg', 'emg', 'eog'] for config 'eeg_emg_eog'
11-06-2025 09:02:41 - svm - INFO - modular_svm - load_data - Data loaded successfully for config 'eeg_emg_eog'
11-06-2025 09:02:41 - svm - INFO - modular_svm - load_data - Shapes: X_train: (15460, 19), y_train: (15460,)
11-06-2025 09:02:41 - svm - INFO - modular_svm - load_data - Shapes: X_val: (488, 19), y_val: (488,)
11-06-2025 09:02:41 - svm - INFO - modular_svm - load_data - Shapes: X_test: (1115, 19), y_test: (1115,)
11-06-2025 09:02:41 - svm - INFO - modular_svm - main_svm - Building SVM Pipeline and Training Model for 'eeg_emg_eog'...
11-06-2025 09:02:41 - svm - INFO - modular_svm - main_svm - Combining X_train and X_val for  RandomizedSearchCV hyperparameter tuning.
11-06-2025 09:02:41 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Min samples per class in HP tuning data: 8
11-06-2025 09:02:41 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - SMOTE k_neighbors robustly set to: 5 based on n_splits=5
11-06-2025 09:02:41 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Starting RandomizedSearchCV with cv=5...
11-06-2025 10:54:31 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best SVM Params from RandomizedSearchCV: {'feature_selection__k': 10, 'pca__n_components': None, 'svm__estimator__C': np.float64(30.682658024414046), 'svm__estimator__gamma': 0.1}
11-06-2025 10:54:31 - svm - INFO - modular_svm - _train_svm_with_randomizedsearch - Best ROC AUC (CV): 0.8592
11-06-2025 10:54:32 - svm - INFO - modular_svm - plot_grid_search_results - RandomizedSearchCV results plot saved to: /scratch/s5130727/Applied-ML/results5/gs_results_eeg_emg_eog.png
11-06-2025 10:54:32 - svm - ERROR - modular_svm - plot_search_history - Could not plot search history: 'mean_train_score'
11-06-2025 10:54:32 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Training set for config 'eeg_emg_eog' ---
11-06-2025 10:59:04 - svm - INFO - modular_svm - _evaluate_model - ROC curves saved to: /scratch/s5130727/Applied-ML/results5/roc_eeg_emg_eog_training.png
11-06-2025 10:59:04 - svm - INFO - modular_svm - _evaluate_model - SVM Training Performance (Config: eeg_emg_eog):
11-06-2025 10:59:04 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.20      1.00      0.33         8
     Class 1       0.25      0.87      0.39       368
     Class 2       0.29      0.76      0.42       656
     Class 3       0.97      0.65      0.78     10892
     Class 4       0.50      0.80      0.62      2008
     Class 5       0.56      0.71      0.63      1528

    accuracy                           0.68     15460
   macro avg       0.46      0.80      0.53     15460
weighted avg       0.82      0.68      0.72     15460

11-06-2025 10:59:04 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.6842, Macro F1: 0.5270, ROC AUC (OVR Macro): 0.9029272239632139
11-06-2025 10:59:04 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Training - Config: eeg_emg_eog):
[[   8    0    0    0    0    0]
 [   1  320   13    5   19   10]
 [   1   27  500   18   43   67]
 [  24  708  944 7049 1452  715]
 [   4  118   95  108 1610   73]
 [   2   93  187   61   95 1090]]
11-06-2025 10:59:04 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_emg_eog_training.png
11-06-2025 10:59:04 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Validation set for config 'eeg_emg_eog' ---
11-06-2025 10:59:10 - svm - WARNING - modular_svm - _evaluate_model - (Validation set, config eeg_emg_eog) Could not compute ROC AUC (ValueError): Number of given labels, 4, not equal to the number of columns in 'y_score', 6.
11-06-2025 10:59:10 - svm - INFO - modular_svm - _evaluate_model - SVM Validation Performance (Config: eeg_emg_eog):
11-06-2025 10:59:10 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       0.86      0.86      0.86         7
     Class 2       0.33      0.49      0.39        43
     Class 3       0.99      0.85      0.92       383
     Class 4       0.00      0.00      0.00         0
     Class 5       0.46      0.73      0.56        55

    accuracy                           0.81       488
   macro avg       0.44      0.49      0.46       488
weighted avg       0.87      0.81      0.83       488

11-06-2025 10:59:10 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.8074, Macro F1: 0.6826, ROC AUC (OVR Macro): N/A
11-06-2025 10:59:10 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Validation - Config: eeg_emg_eog):
[[  0   0   0   0   0   0]
 [  0   6   0   0   0   1]
 [  0   0  21   2   0  20]
 [  0   1  29 327   0  26]
 [  0   0   0   0   0   0]
 [  0   0  14   1   0  40]]
11-06-2025 10:59:10 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_emg_eog_validation.png
11-06-2025 10:59:10 - svm - INFO - modular_svm - _evaluate_model - --- Evaluating on Test set for config 'eeg_emg_eog' ---
11-06-2025 10:59:23 - svm - WARNING - modular_svm - _evaluate_model - (Test set, config eeg_emg_eog) Could not compute ROC AUC (ValueError): Number of given labels, 5, not equal to the number of columns in 'y_score', 6.
11-06-2025 10:59:23 - svm - INFO - modular_svm - _evaluate_model - SVM Test Performance (Config: eeg_emg_eog):
11-06-2025 10:59:23 - svm - INFO - modular_svm - _evaluate_model - 
              precision    recall  f1-score   support

     Class 0       0.00      0.00      0.00         0
     Class 1       1.00      0.46      0.63        48
     Class 2       0.25      0.32      0.28        85
     Class 3       0.84      0.84      0.84       665
     Class 4       0.70      0.89      0.78       187
     Class 5       0.69      0.47      0.56       130

    accuracy                           0.75      1115
   macro avg       0.58      0.49      0.51      1115
weighted avg       0.76      0.75      0.75      1115

11-06-2025 10:59:23 - svm - INFO - modular_svm - _evaluate_model - Accuracy: 0.7462, Macro F1: 0.6176, ROC AUC (OVR Macro): N/A
11-06-2025 10:59:23 - svm - INFO - modular_svm - _evaluate_model - Confusion Matrix (Test - Config: eeg_emg_eog):
[[  0   0   0   0   0   0]
 [  0  22  10  14   0   2]
 [  0   0  27  35   3  20]
 [  0   0  34 556  69   6]
 [  0   0   1  20 166   0]
 [  0   0  35  34   0  61]]
11-06-2025 10:59:23 - svm - INFO - modular_svm - plot_confusion_matrix - Confusion matrix plot saved to: /scratch/s5130727/Applied-ML/results5/cm_eeg_emg_eog_test.png
11-06-2025 10:59:23 - svm - INFO - modular_svm - main_svm - Successfully saved best model for 'eeg_emg_eog' to: /scratch/s5130727/Applied-ML/results5/svm_model_eeg_emg_eog.joblib
11-06-2025 10:59:23 - svm - INFO - modular_svm - main_svm - Preparing a plot-safe estimator for the learning curve.
11-06-2025 10:59:23 - svm - INFO - modular_svm - main_svm - Set smote__k_neighbors=1 in plot-safe estimator.
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:960: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 949, in _score
    scores = scorer(estimator, X_test, y_test, **score_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_scorer.py", line 388, in _score
    return self._sign * self._score_func(y_true, y_pred, **scoring_kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 635, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 752, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Number of classes in y_true not equal to the number of columns in 'y_score'

  warnings.warn(
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py:528: FitFailedWarning: 
2 fits failed out of a total of 25.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
2 fits failed with the following error:
Traceback (most recent call last):
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 518, in fit
    Xt, yt = self._fit(X, y, routed_params, raw_params=params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 440, in _fit
    X, y, fitted_transformer = fit_resample_one_cached(
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/joblib/memory.py", line 326, in __call__
    return self.func(*args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/pipeline.py", line 1336, in _fit_resample_one
    X_res, y_res = sampler.fit_resample(X, y, **params.get("fit_resample", {}))
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/base.py", line 105, in fit_resample
    output = self._fit_resample(X, y, **params)
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/imblearn/over_sampling/_smote/base.py", line 359, in _fit_resample
    nns = self.nn_k_.kneighbors(X_class, return_distance=False)[:, 1:]
  File "/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/sklearn/neighbors/_base.py", line 854, in kneighbors
    raise ValueError(
ValueError: Expected n_neighbors <= n_samples_fit, but n_neighbors = 2, n_samples_fit = 1, n_samples = 1

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/scratch/s5130727/Applied-ML/src/models/modular_svm.py:728: RuntimeWarning: Mean of empty slice
  val_scores_mean = np.nanmean(val_scores, axis=1)
/home4/s5130727/.conda/envs/AML/lib/python3.10/site-packages/numpy/lib/_nanfunctions_impl.py:2019: RuntimeWarning: Degrees of freedom <= 0 for slice.
  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
11-06-2025 11:17:57 - svm - INFO - modular_svm - plot_learning_curve - Learning curve plot saved to: /scratch/s5130727/Applied-ML/results5/lc_eeg_emg_eog.png
11-06-2025 11:17:57 - svm - INFO - modular_svm - main_svm - Metrics for 'eeg_emg_eog' saved to: /scratch/s5130727/Applied-ML/results5/metrics_eeg_emg_eog.json
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results - 

--- Overall Summary of SVM Model Runs ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results - 
Configuration: eeg (Processed 1 time(s))
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Training Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.6842 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.5270 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): 0.9029 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Validation Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.8074 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6826 +/- 0.0000 (1 run)
/scratch/s5130727/Applied-ML/src/models/modular_svm.py:633: RuntimeWarning: Mean of empty slice
  np.nanmean(metric_values) if metric_values else np.nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Test Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.7462 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6176 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results - 
Configuration: eeg_emg (Processed 1 time(s))
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Training Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.6842 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.5270 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): 0.9029 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Validation Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.8074 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6826 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Test Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.7462 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6176 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results - 
Configuration: eeg_eog (Processed 1 time(s))
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Training Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.6842 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.5270 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): 0.9029 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Validation Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.8074 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6826 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Test Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.7462 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6176 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results - 
Configuration: eeg_emg_eog (Processed 1 time(s))
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Training Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.6842 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.5270 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): 0.9029 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Validation Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.8074 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6826 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   --- Test Set Metrics ---
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Accuracy: 0.7462 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean Macro F1-score: 0.6176 +/- 0.0000 (1 run)
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results -   Mean ROC AUC (OVR Macro): nan +/- nan
11-06-2025 11:17:57 - svm - INFO - modular_svm - _log_overall_results - --- End of Overall Summary ---
